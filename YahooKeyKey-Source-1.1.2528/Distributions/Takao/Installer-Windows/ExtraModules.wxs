<?xml version="1.0" encoding="utf-8"?>
<!--
    # This comment is generated by WixEdit, the specific commandline
    # arguments for the WiX Toolset are stored here.

    candleArgs: "<projectfile>" -out "<projectname>.wixobj" <extensions>
    lightArgs: "<projectname>.wixobj" -out "<projectname>.msi" <extensions> "C:\Program Files\Windows Installer XML\bin\wixui.wixlib" -loc "wixui_zh-tw.wxl
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2003/01/wi">
  <Product Id="C470FA12-FA2F-CF51-B6D1-930837587130" Name="Yahoo! 奇摩輸入法外掛安裝包 1.1 正式版 (build 2528)" Language="1028" Version="1.1.2528" Manufacturer="Yahoo! Inc." Codepage="950" UpgradeCode="D35B8B67-6DBD-49EB-BD2D-10AEBD946E8E">
    <Package Id="EE54E4D8-9998-B45A-8097-759311D3FC59" Description="Yahoo! KeyKey Input Method" Comments="The main package of the Yahoo! KeyKey Input Method" InstallerVersion="200" Compressed="yes" Manufacturer="Yahoo Inc." />
    <Condition Message="You need to be an administrator to install this product.">Privileged</Condition>
    <Condition Message="You need to be an administrator to install this product.">AdminUser</Condition>
    <Condition Message="This application requires Windows XP or higher version.">VersionNT</Condition>
    <Property Id="ARPPRODUCTICON" Value="Product.ico" />
    <UIRef Id="WixUI_FeatureTree" />
    <Binary Id="ServerShooter" SourceFile="Binary\ServerShooter.dll" />
    <Media Id="1" Cabinet="Product.cab" EmbedCab="yes" />
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="AppDataFolder">
        <Directory Id="YAHOOKEYKEY" LongName="Yahoo! KeyKey" Name="YAHOOKK">
          <Directory Id="Modules" Name="Modules">
            <Directory Id="YKAFWordCount.ykmodule" LongName="YKAFWordCount.ykmodule" Name="YKAFWC.YKM">
              <Component Id="YKAFWordCount" Guid="105B8365-5309-4B87-A9A5-81711F7A4D80">
                <File Id="YKAFWordCount.dll" Name="YKAFWC.DLL" DiskId="1" LongName="YKAFWordCount.dll" Source="..\..\..\release\Modules\YKAFWordCount.ykmodule\YKAFWordCount.dll" Vital="yes" />
                <File Id="YKAFWordCount_ModulePackage.plist" Name="WCMDLPKG.PLS" DiskId="1" LongName="ModulePackage.plist" Source="..\..\..\release\Modules\YKAFWordCount.ykmodule\ModulePackage.plist" Vital="yes" />
              </Component>
            </Directory>
            <Directory Id="YKPhraseConverter.ykmodule" LongName="YKPhraseConverter.ykmodule" Name="YKPC.YKM">
              <Component Id="YKPhraseConverter" Guid="60C8A357-79F9-4414-B585-4B498BF733C2">
                <File Id="YKPhraseConverter.dll" Name="YKPC.DLL" DiskId="1" LongName="YKPhraseConverter.dll" Source="..\..\..\release\Modules\YKPhraseConverter.ykmodule\YKPhraseConverter.dll" Vital="yes" />
                <File Id="Phrases.cin" Name="Phrases.cin" DiskId="1" Source="..\..\..\release\Modules\YKPhraseConverter.ykmodule\Phrases.cin" Vital="yes" />
                <File Id="YKPhraseConverter_ModulePackage.plist" Name="MDLPKG.PLS" DiskId="1" Source="..\..\..\release\Modules\YKPhraseConverter.ykmodule\ModulePackage.plist" Vital="yes" LongName="ModulePackage.plist" />
              </Component>
            </Directory>
            <Directory Id="YKReverseLookup.ykmodule" Name="YKRL.YKM" LongName="YKReverseLookup.ykmodule">
              <Component Id="YKReverseLookup" Guid="2CADD8FC-CB6C-48D3-B6BA-BC6C5DDBE969">
                <File Id="YKReverseLookup.dll" Name="YKRL.DLL" DiskId="1" Source="..\..\..\release\Modules\YKReverseLookup.ykmodule\YKReverseLookup.dll" Vital="yes" LongName="YKReverseLookup.dll" />
                <File Id="YKReverseLookup_ModulePackage.plist" Name="MDLPKG.PLS" DiskId="1" LongName="ModulePackage.plist" Source="..\..\..\release\Modules\YKReverseLookup.ykmodule\ModulePackage.plist" Vital="yes" />
              </Component>
            </Directory>
          </Directory>
        </Directory>
      </Directory>
    </Directory>
    <Feature Id="Complete" Title="完整安裝包" Description="完整安裝包" Display="expand" Level="1" TypicalDefault="install" Absent="disallow" InstallDefault="local" AllowAdvertise="no">
      <Feature Id="YKAFWordCount" Level="1" Description="計算您用 Yahoo! 奇摩輸入法打過多少字" Display="expand" Title="字數統計功能" Absent="allow" AllowAdvertise="no">
        <ComponentRef Id="YKAFWordCount" />
      </Feature>
      <Feature Id="YKPhraseConverter" Level="1" Absent="allow" AllowAdvertise="no" Description="將繁體中文的詞彙轉成簡體中文的習慣" Title="簡體中文常用詞彙轉換">
        <ComponentRef Id="YKPhraseConverter" />
      </Feature>
      <Feature Id="YKReverseLookup" Level="1" Absent="allow" AllowAdvertise="no" Description="打字時顯示這個字的注音、倉頡或拼音碼" Display="expand" Title="字根反查">
        <ComponentRef Id="YKReverseLookup" />
      </Feature>
    </Feature>
    <AdminExecuteSequence />
    <InstallUISequence>
    </InstallUISequence>
    <InstallExecuteSequence>
      <Custom Action="StopUsingSignedModules" Before="InstallValidate" />
      <Custom Action="ResumeUsingSignedModules" After="InstallFinalize" />
			<!-- this will always be scheduled RIGHT AFTER InstallFinalize, so place doesn't matter -->
			<RemoveExistingProducts After="InstallFinalize">PREVIOUSVERSIONFOUND</RemoveExistingProducts>

    </InstallExecuteSequence>
    <Binary Id="bannrbmp" src="Binary\bannrbmp.bmp" />
    <Binary Id="completi" src="Binary\completi.ico" />
    <Binary Id="custicon" src="Binary\custicon.ico" />
    <Binary Id="dlgbmp" src="Binary\dlgbmp.bmp" />
    <Binary Id="exclamic" src="Binary\exclamic.ico" />
    <Binary Id="info" src="Binary\info.ico" />
    <Binary Id="insticon" src="Binary\insticon.ico" />
    <Binary Id="New" src="Binary\New.ico" />
    <Binary Id="removico" src="Binary\removico.ico" />
    <Binary Id="repairic" src="Binary\repairic.ico" />
    <Binary Id="Up" src="Binary\Up.ico" />
    <CustomAction Id="StopUsingSignedModules" BinaryKey="ServerShooter" DllEntry="StopUsingSignedModules" Return="ignore" />
    <CustomAction Id="ResumeUsingSignedModules" BinaryKey="ServerShooter" DllEntry="ResumeUsingSignedModules" Return="ignore" />
    <UI />
    <Icon Id="Product.ico" SourceFile="Binary\Product.ico" />
    <Upgrade Id="D35B8B67-6DBD-49EB-BD2D-10AEBD946E8E">
      <UpgradeVersion OnlyDetect="no" Property="PREVIOUSVERSIONFOUND" Maximum="1.1.2528" IncludeMaximum="no" />
      <UpgradeVersion OnlyDetect="yes" Property="NEWERVERSIONFOUND" Minimum="1.1.2528" IncludeMinimum="no" />
    </Upgrade>
  </Product>
</Wix>
